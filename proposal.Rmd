---
title: "Untitled"
author: "Zhengao.Chen"
date: "2024-03-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r, warning = FALSE, message = FALSE}
library(dplyr)
library(tidyverse)
library(ggplot2)
links <- read.csv("C:/Users/11479/Desktop/R Proposal/links.csv")
movies <- read.csv("C:/Users/11479/Desktop/R Proposal/movies.csv")
ratings <- read.csv("C:/Users/11479/Desktop/R Proposal/ratings.csv")
head(ratings)
```

```{r, warning = FALSE, message = FALSE}

merged_data <- merge(x = links, y = movies, by = "movieId")
ratings <- ratings %>% group_by(movieId) %>%
  summarise(avg_rating=mean(rating))
merged_data <- merge(x = ratings, y = merged_data, by = "movieId")

names(merged_data)
merged_data$genre_count <- str_count(merged_data$genres, "\\|") + 1

```

```{r, warning = FALSE, message = FALSE}
#analyzing the rating range and distributions of the movies
library(ggplot2)
ggplot(merged_data, aes(x = avg_rating)) + geom_bar()
q25 <- quantile(merged_data$avg_rating, probs = 0.25)
q50 <- mean(merged_data$avg_rating)
q75 <- quantile(merged_data$avg_rating, probs = 0.75)

ggplot(merged_data, aes(x = avg_rating)) + 
     geom_histogram(binwidth=0.5) + 
     geom_vline(xintercept = q25, linetype="dashed", color = "blue", size=1) + 
     geom_vline(xintercept = q75, linetype="dashed", color = "red", size=1) + 
      geom_vline(xintercept=q50, linetype="dashed",color='purple',size=1) +
     labs(title="rating range of the movie database", x="rating", y="amount") +
    annotate("text", x = q25, y = 0, label = paste("25th:", q25), vjust = 1, color = "blue") +
  annotate("text", x = q50, y = 0, label = paste("50th:", q50), vjust = -1.5, color = "purple") +
  annotate("text", x = q75, y = 0, label = paste("75th:", q75), vjust = -2, color = "red")
```

From the plot, some directional insights can be discerned:
Central Tendency: A noticeable bulge in the bar height around the median rating signifies that a substantial number of movies receive average scores, which equals to around 3.5 This clustering around the median suggests that while some films score exceptionally high or low, most garner moderate ratings. Such a pattern could imply a consistent quality in the movie selection or a general tendency of the audience to rate movies as average.

Diversity in Ratings: The substantial distance between the 25th percentile (blue dashed line) and the 75th percentile (red dashed line) indicates a wide distribution of ratings. The bar chart has also indicated this pattern, where most of the rating lie in 3 and 4. Therefore, our analysis can be furthur directed in this way, to determine whether it will be a mediocore movie(rating of around 3), or a phenomenal movie(rating of more than 3)

This directs our analysis into more investigations to determine which features will influence the final ratings.


```{r, warning = FALSE, message = FALSE}

genres_ratings_10 <- merged_data %>%
  group_by(genres) %>%
  summarise(average_rating = mean(avg_rating, na.rm = TRUE)) %>%
  arrange(desc(average_rating)) %>%
  slice_head(n=10)

movies_over_4_rating <- merged_data %>%
  filter(avg_rating >= 4)
movies_under_2_rating <- merged_data %>%
  filter(avg_rating <=2)

genres_separated <- movies_over_4_rating %>%
  separate_rows(genres, sep = "\\|")
genres_separated_low <- movies_under_2_rating %>%
  separate_rows(genres, sep="\\|")

genre_counts <- genres_separated %>%
  count(genres, name = "count") %>%
  arrange(desc(count)) %>%
  slice_head(n=10)
genre_counts_low <- genres_separated_low %>%
  count(genres, name="count") %>%
  arrange(desc(count)) %>%
  slice_head(n=10)

ggplot(genre_counts, aes(x = genres, y=count, fill=genres )) + 
     geom_bar(stat="identity")
ggplot(genre_counts_low, aes(x = genres, y=count,fill=genres )) + 
     geom_bar(stat="identity") 


```

The bar chart depicts the count of movies with a rating greater than 4 across various genres. Drama leads significantly, suggesting a preference for this genre among highly-rated movies. Documentary and Comedy genres also show substantial counts, indicating their strong presence among movies with high ratings.
In contrast, genres such as Action, Animation, Crime, Horror, Romance, and Thriller have notably fewer high-rated movies, with Horror having the least. This distribution implies that audiences and critics might favor storytelling and content often associated with Drama and Documentaries over the elements typically found in the other listed genres when it comes to highly-rated films.

From the bar graph of the genre counts for movies with a rating equal or less than 2. Drama, which dominated in higher ratings, appears less frequently here, indicating it is generally well-received. Comedy, the runner-up in higher ratings, is most prevalent among lower-rated movies, suggesting a polarized reception. Genres like Action and Thriller also appear more commonly at this lower rating spectrum, potentially reflecting a critical view of certain films within these genres. Sci-Fi and Romance show moderate counts, while Children's movies are least represented, suggesting these genres may fare moderately in terms of reception.
Combining this with the summary for movies rated 4 and above, there is a noticeable contrast: genres that excel in higher ratings such as Drama and Documentary are less common among lower-rated movies. This could imply that well-executed dramas and documentaries resonate well with audiences, whereas comedies can be hit-or-miss. Action and Thriller genres, while not as frequent among top-rated movies, appear more at the lower end of ratings, which may indicate a consistency in lower critical reception or a divide in audience preference.


```{r, warning = FALSE, message = FALSE}
genrecount_rating <- merged_data %>%
  group_by(genre_count) %>%
  summarise(rating = mean(avg_rating))

ggplot(genrecount_rating, aes(x = genre_count, y=rating, fill=genre_count )) + 
     geom_bar(stat="identity") 
```

The bar chart appears to plot the relationship between the number of genres associated with a movie and its average rating. The trend suggests that movies encompassing a wider range of genres do not necessarily receive higher average ratings. Interestingly, films with a singular genre focus tend to have moderate ratings. There's a noticeable peak for movies that span approximately ten genres, which receive the highest average ratings, indicating a potential sweet spot where a broad genre diversity correlates with a higher appreciation from viewers or critics. However, the ratings dip slightly for movies with slightly fewer genres, around seven to nine, before peaking. This pattern might imply that beyond a certain point, adding more genres does not enhance a movie's reception and could even detract from its overall quality or coherence.


Research Question:
The variety of the content (numbers of the genres) influence the general rating?
Which genres are more welcomed by the viewers in the past 3 decades?
Which genres generated more revenues and interests than the others?
Is the popularity of the top casts must lead to larger consumer base and business success of the movies?
The actor casting in movies of his major genres vs the actor casting in movies of his genres, which kind of movies will be more welcomed and be more considered as a business success?

